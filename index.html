<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoClinic - Sistema Integral de Datos Clínicos Neonatales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .slide {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        
        .card-elegant {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .card-elegant:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.15);
        }
        
        .icon-gradient {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .fade-in {
            animation: fadeIn 1s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .stagger-item {
            opacity: 0;
            animation: staggerIn 0.8s ease forwards;
        }
        
        .stagger-item:nth-child(1) { animation-delay: 0.2s; }
        .stagger-item:nth-child(2) { animation-delay: 0.4s; }
        .stagger-item:nth-child(3) { animation-delay: 0.6s; }
        .stagger-item:nth-child(4) { animation-delay: 0.8s; }
        .stagger-item:nth-child(5) { animation-delay: 1.0s; }
        .stagger-item:nth-child(6) { animation-delay: 1.2s; }
        
        @keyframes staggerIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
            }
            50% { 
                box-shadow: 0 0 40px rgba(59, 130, 246, 0.6);
            }
        }
        
        .morphing-bg {
            background: linear-gradient(-45deg, #3b82f6, #8b5cf6, #ec4899, #f97316);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .objective-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(248,250,252,0.9));
            border-left: 4px solid;
            transition: all 0.3s ease;
        }
        
        .objective-card:hover {
            transform: translateX(5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="morphing-bg min-h-full">
    <!-- Slide 1: Portada -->
    <section class="slide">
        <div class="card-elegant p-12 max-w-4xl w-full text-center fade-in">
            <div class="floating mb-8">
                <div class="w-24 h-24 bg-gradient-to-br from-blue-600 via-purple-600 to-pink-500 rounded-3xl flex items-center justify-center mx-auto shadow-2xl pulse-glow">
                    <!-- Logo SVG -->
                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M24 8C28 8 31 11 31 15C31 19 28 22 24 22C20 22 17 19 17 15C17 11 20 8 24 8Z" fill="white" opacity="0.9"/>
                        <path d="M8 28L12 28L14 24L17 32L20 18L23 38L26 24L28 28L40 28" stroke="white" stroke-width="3" fill="none" opacity="0.8"/>
                        <rect x="22" y="32" width="4" height="12" rx="2" fill="white" opacity="0.7"/>
                        <rect x="16" y="37" width="16" height="4" rx="2" fill="white" opacity="0.7"/>
                    </svg>
                </div>
            </div>
            
            <h1 class="text-5xl font-bold mb-4">
                <span class="icon-gradient">NeoClinic</span>
            </h1>
            <h2 class="text-2xl text-gray-700 mb-6">Sistema Integral de Datos Clínicos Neonatales</h2>
            
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 mb-8">
                <p class="text-lg text-gray-700 leading-relaxed">
                    Sistema integral para optimizar el cuidado de enfermería
                </p>
            </div>
            
            <div class="grid grid-cols-3 gap-6 text-center">
                <div class="stagger-item">
                    <div class="text-3xl mb-2">👶</div>
                    <div class="text-sm font-medium text-gray-600">Cuidado Neonatal</div>
                </div>
                <div class="stagger-item">
                    <div class="text-3xl mb-2">📊</div>
                    <div class="text-sm font-medium text-gray-600">Datos Precisos</div>
                </div>
                <div class="stagger-item">
                    <div class="text-3xl mb-2">🤱</div>
                    <div class="text-sm font-medium text-gray-600">Enfermería Especializada</div>
                </div>
            </div>
            
            <!-- Información del Autor - EDITABLE -->
            <div class="mt-8 bg-white/80 backdrop-blur-sm p-6 rounded-xl border border-gray-200">
                <h3 class="text-lg font-bold text-gray-700 mb-4">📋 Información del Proyecto</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label for="nombreAutor" class="block text-xs font-medium text-gray-600 mb-1">Presentado por:</label>
                        <input type="text" id="nombreAutor" 
                               class="w-full p-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                               placeholder="Tu nombre completo"
                               value="">
                    </div>
                    <div>
                        <label for="nombreAsesora" class="block text-xs font-medium text-gray-600 mb-1">Asesora:</label>
                        <input type="text" id="nombreAsesora" 
                               class="w-full p-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" 
                               placeholder="Nombre de la asesora"
                               value="">
                    </div>
                    <div>
                        <label for="fechaPresentacion" class="block text-xs font-medium text-gray-600 mb-1">Fecha de Presentación:</label>
                        <input type="date" id="fechaPresentacion" 
                               class="w-full p-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="institucion" class="block text-xs font-medium text-gray-600 mb-1">Institución:</label>
                        <input type="text" id="institucion" 
                               class="w-full p-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" 
                               placeholder="Universidad/Institución"
                               value="">
                    </div>
                    <div>
                        <label for="programa" class="block text-xs font-medium text-gray-600 mb-1">Programa Académico:</label>
                        <input type="text" id="programa" 
                               class="w-full p-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500" 
                               placeholder="Ej: Licenciatura en Enfermería"
                               value="">
                    </div>
                </div>
                
                <div class="text-center mb-4">
                    <button type="button" onclick="guardarInfoAutor()" 
                            class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg">
                        💾 Guardar Información del Proyecto
                    </button>
                </div>
                
                <!-- Información guardada (se muestra después de guardar) -->
                <div id="infoAutorGuardada" class="hidden">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h4 class="font-bold text-green-800 mb-2">✅ Información Guardada:</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-green-700">
                            <div><strong>Autor:</strong> <span id="autorMostrado"></span></div>
                            <div><strong>Asesora:</strong> <span id="asesoraMostrada"></span></div>
                            <div><strong>Fecha:</strong> <span id="fechaMostrada"></span></div>
                            <div><strong>Institución:</strong> <span id="institucionMostrada"></span></div>
                            <div class="md:col-span-2"><strong>Programa:</strong> <span id="programaMostrado"></span></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Botón para continuar al sistema -->
            <div class="mt-8">
                <button onclick="mostrarSistema()" 
                        class="bg-gradient-to-r from-green-600 to-blue-600 text-white px-8 py-3 rounded-xl font-bold text-lg hover:from-green-700 hover:to-blue-700 transition-all shadow-xl transform hover:scale-105">
                    🚀 Acceder al Sistema NeoClinic
                </button>
            </div>
        </div>
    </section>

    <!-- Sistema Principal (inicialmente oculto) -->
    <div id="sistemaPrincipal" class="hidden min-h-full bg-gradient-to-br from-blue-50 via-white to-purple-50">
        <div class="container mx-auto p-6">
            <!-- Header del Sistema -->
            <header class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center">
                            <svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M24 8C28 8 31 11 31 15C31 19 28 22 24 22C20 22 17 19 17 15C17 11 20 8 24 8Z" fill="white"/>
                                <path d="M8 28L12 28L14 24L17 32L20 18L23 38L26 24L28 28L40 28" stroke="white" stroke-width="2" fill="none"/>
                            </svg>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800">NeoClinic</h1>
                            <p class="text-gray-600">Sistema de Datos Clínicos Neonatales</p>
                        </div>
                    </div>
                    <button onclick="volverPortada()" 
                            class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg transition-colors">
                        ← Volver a Portada
                    </button>
                </div>
            </header>

            <!-- Formulario Principal -->
            <div class="bg-white rounded-2xl shadow-xl p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">📋 Registro de Datos Neonatales</h2>
                
                <form id="clinicalDataForm">
                    <!-- Datos Básicos -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div>
                            <label for="expediente" class="block text-sm font-medium text-gray-700 mb-2">Número de Expediente</label>
                            <input type="text" id="expediente" name="expediente" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                   placeholder="Ej: NEO-2024-001" required>
                        </div>
                        <div>
                            <label for="fechaNacimiento" class="block text-sm font-medium text-gray-700 mb-2">Fecha de Nacimiento</label>
                            <input type="date" id="fechaNacimiento" name="fechaNacimiento" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label for="sexo" class="block text-sm font-medium text-gray-700 mb-2">Sexo</label>
                            <select id="sexo" name="sexo" 
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                <option value="">Seleccionar...</option>
                                <option value="masculino">Masculino</option>
                                <option value="femenino">Femenino</option>
                            </select>
                        </div>
                    </div>

                    <!-- Datos Antropométricos -->
                    <div class="bg-blue-50 rounded-xl p-6 mb-8">
                        <h3 class="text-lg font-bold text-blue-800 mb-4">📏 Datos Antropométricos</h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label for="peso" class="block text-sm font-medium text-gray-700 mb-2">Peso (gramos)</label>
                                <input type="number" id="peso" name="peso" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                       placeholder="2500" min="500" max="6000" required>
                            </div>
                            <div>
                                <label for="talla" class="block text-sm font-medium text-gray-700 mb-2">Talla (cm)</label>
                                <input type="number" id="talla" name="talla" step="0.1"
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                       placeholder="48.5" min="25" max="60" required>
                            </div>
                            <div>
                                <label for="pc" class="block text-sm font-medium text-gray-700 mb-2">Perímetro Cefálico (cm)</label>
                                <input type="number" id="pc" name="pc" step="0.1"
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                       placeholder="33.5" min="20" max="45" required>
                            </div>
                            <div>
                                <label for="edadGestacional" class="block text-sm font-medium text-gray-700 mb-2">Edad Gestacional (semanas)</label>
                                <input type="number" id="edadGestacional" name="edadGestacional" step="0.1"
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                       placeholder="38.2" min="22" max="44" required>
                            </div>
                        </div>
                    </div>

                    <!-- Escalas Clínicas -->
                    <div class="bg-purple-50 rounded-xl p-6 mb-8">
                        <h3 class="text-lg font-bold text-purple-800 mb-4">🏥 Escalas Clínicas</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- APGAR -->
                            <div class="bg-white p-4 rounded-lg">
                                <h4 class="font-bold text-gray-700 mb-3">Escala APGAR</h4>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label for="apgar1" class="block text-sm text-gray-600 mb-1">1 minuto</label>
                                        <input type="number" id="apgar1" name="apgar1" 
                                               class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500" 
                                               min="0" max="10" placeholder="8">
                                    </div>
                                    <div>
                                        <label for="apgar5" class="block text-sm text-gray-600 mb-1">5 minutos</label>
                                        <input type="number" id="apgar5" name="apgar5" 
                                               class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500" 
                                               min="0" max="10" placeholder="9">
                                    </div>
                                </div>
                            </div>

                            <!-- Silverman -->
                            <div class="bg-white p-4 rounded-lg">
                                <h4 class="font-bold text-gray-700 mb-3">Escala Silverman-Andersen</h4>
                                <div>
                                    <label for="silverman" class="block text-sm text-gray-600 mb-1">Puntuación Total</label>
                                    <input type="number" id="silverman" name="silverman" 
                                           class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500" 
                                           min="0" max="10" placeholder="2">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Botón de Procesar -->
                    <div class="text-center">
                        <button type="submit" 
                                class="bg-gradient-to-r from-green-600 to-blue-600 text-white px-8 py-4 rounded-xl font-bold text-lg hover:from-green-700 hover:to-blue-700 transition-all shadow-xl transform hover:scale-105">
                            📊 Procesar Datos y Generar Reporte
                        </button>
                    </div>
                </form>
            </div>

            <!-- Área de Resultados -->
            <div id="resultadosArea" class="hidden mt-8">
                <div class="bg-white rounded-2xl shadow-xl p-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">📈 Resultados del Análisis</h2>
                    <div id="clinicalSummary"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let datosActuales = {};

        // Función para mostrar el sistema principal
        function mostrarSistema() {
            document.querySelector('.slide').style.display = 'none';
            document.getElementById('sistemaPrincipal').classList.remove('hidden');
        }

        // Función para volver a la portada
        function volverPortada() {
            document.querySelector('.slide').style.display = 'flex';
            document.getElementById('sistemaPrincipal').classList.add('hidden');
        }

        // Función para guardar información del autor
        function guardarInfoAutor() {
            const autor = document.getElementById('nombreAutor').value;
            const asesora = document.getElementById('nombreAsesora').value;
            const fecha = document.getElementById('fechaPresentacion').value;
            const institucion = document.getElementById('institucion').value;
            const programa = document.getElementById('programa').value;
            
            if (!autor || !asesora) {
                mostrarNotificacion('Por favor ingresa al menos tu nombre y el de tu asesora', 'warning');
                return;
            }
            
            // Guardar en localStorage
            const infoAutor = {
                autor: autor,
                asesora: asesora,
                fecha: fecha,
                institucion: institucion,
                programa: programa,
                fechaGuardado: new Date().toISOString()
            };
            
            localStorage.setItem('neoclinic_info_autor', JSON.stringify(infoAutor));
            
            // Mostrar información guardada
            document.getElementById('autorMostrado').textContent = autor;
            document.getElementById('asesoraMostrada').textContent = asesora;
            document.getElementById('fechaMostrada').textContent = fecha ? new Date(fecha).toLocaleDateString('es-ES') : 'No especificada';
            document.getElementById('institucionMostrada').textContent = institucion || 'No especificada';
            document.getElementById('programaMostrado').textContent = programa || 'No especificado';
            
            document.getElementById('infoAutorGuardada').classList.remove('hidden');
            
            // Actualizar título del documento
            document.title = `NeoClinic - ${autor}`;
            
            // Mostrar confirmación
            mostrarNotificacion('✅ Información del proyecto guardada exitosamente', 'success');
        }
        
        // Función para cargar información del autor al iniciar
        function cargarInfoAutor() {
            const infoGuardada = localStorage.getItem('neoclinic_info_autor');
            if (infoGuardada) {
                const info = JSON.parse(infoGuardada);
                
                document.getElementById('nombreAutor').value = info.autor || '';
                document.getElementById('nombreAsesora').value = info.asesora || '';
                document.getElementById('fechaPresentacion').value = info.fecha || '';
                document.getElementById('institucion').value = info.institucion || '';
                document.getElementById('programa').value = info.programa || '';
                
                // Mostrar información si está completa
                if (info.autor && info.asesora) {
                    document.getElementById('autorMostrado').textContent = info.autor;
                    document.getElementById('asesoraMostrada').textContent = info.asesora;
                    document.getElementById('fechaMostrada').textContent = info.fecha ? new Date(info.fecha).toLocaleDateString('es-ES') : 'No especificada';
                    document.getElementById('institucionMostrada').textContent = info.institucion || 'No especificada';
                    document.getElementById('programaMostrado').textContent = info.programa || 'No especificado';
                    
                    document.getElementById('infoAutorGuardada').classList.remove('hidden');
                    document.title = `NeoClinic - ${info.autor}`;
                }
            }
        }
        
        // Función para mostrar notificaciones
        function mostrarNotificacion(mensaje, tipo = 'info') {
            const colores = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                info: 'bg-blue-600',
                warning: 'bg-yellow-600'
            };
            
            const notificacion = document.createElement('div');
            notificacion.className = `fixed top-4 right-4 ${colores[tipo]} text-white p-4 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300`;
            notificacion.textContent = mensaje;
            
            document.body.appendChild(notificacion);
            
            // Animar entrada
            setTimeout(() => {
                notificacion.classList.remove('translate-x-full');
            }, 100);
            
            // Remover después de 3 segundos
            setTimeout(() => {
                notificacion.classList.add('translate-x-full');
                setTimeout(() => {
                    if (document.body.contains(notificacion)) {
                        document.body.removeChild(notificacion);
                    }
                }, 300);
            }, 3000);
        }

        // Función para calcular percentiles (simplificada)
        function calcularPercentiles(peso, talla, pc, edadGestacional, sexo) {
            // Valores de referencia simplificados para demostración
            const referencias = {
                masculino: {
                    peso: { p10: 2200, p50: 3200, p90: 4200 },
                    talla: { p10: 46, p50: 50, p90: 54 },
                    pc: { p10: 32, p50: 35, p90: 38 }
                },
                femenino: {
                    peso: { p10: 2100, p50: 3100, p90: 4000 },
                    talla: { p10: 45, p50: 49, p90: 53 },
                    pc: { p10: 31, p50: 34, p90: 37 }
                }
            };

            const ref = referencias[sexo] || referencias.masculino;
            
            function getPercentil(valor, referencia) {
                if (valor < referencia.p10) return "< P10";
                if (valor < referencia.p50) return "P10-P50";
                if (valor < referencia.p90) return "P50-P90";
                return "> P90";
            }

            return {
                peso: getPercentil(peso, ref.peso),
                talla: getPercentil(talla, ref.talla),
                pc: getPercentil(pc, ref.pc)
            };
        }

        // Función para interpretar APGAR
        function interpretarApgar(apgar1, apgar5) {
            function interpretar(score) {
                if (score >= 7) return { nivel: "Normal", color: "text-green-600", descripcion: "Buena adaptación" };
                if (score >= 4) return { nivel: "Moderado", color: "text-yellow-600", descripcion: "Dificultad leve" };
                return { nivel: "Severo", color: "text-red-600", descripcion: "Requiere intervención inmediata" };
            }

            return {
                minuto1: interpretar(apgar1),
                minuto5: interpretar(apgar5)
            };
        }

        // Función para interpretar Silverman
        function interpretarSilverman(score) {
            if (score === 0) return { nivel: "Sin dificultad", color: "text-green-600", descripcion: "Respiración normal" };
            if (score <= 3) return { nivel: "Dificultad leve", color: "text-yellow-600", descripcion: "Monitoreo cercano" };
            if (score <= 6) return { nivel: "Dificultad moderada", color: "text-orange-600", descripcion: "Intervención necesaria" };
            return { nivel: "Dificultad severa", color: "text-red-600", descripcion: "Intervención inmediata" };
        }

        // Función para generar diagnósticos NANDA
        function generarDiagnosticosNANDA(datos, percentiles, apgarInterpretacion, silvermanInterpretacion) {
            const diagnosticos = [];

            // Diagnósticos basados en peso
            if (datos.peso < 2500) {
                diagnosticos.push({
                    codigo: "00001",
                    diagnostico: "Desequilibrio nutricional: inferior a las necesidades corporales",
                    relacionado: "Bajo peso al nacer",
                    evidencia: `Peso: ${datos.peso}g (< 2500g)`,
                    noc: "Estado nutricional",
                    nic: "Manejo de la nutrición, Monitoreo nutricional"
                });
            }

            // Diagnósticos basados en APGAR
            if (datos.apgar5 < 7) {
                diagnosticos.push({
                    codigo: "00029",
                    diagnostico: "Disminución del gasto cardíaco",
                    relacionado: "Compromiso de la función cardiopulmonar",
                    evidencia: `APGAR 5 min: ${datos.apgar5}`,
                    noc: "Efectividad de la bomba cardíaca",
                    nic: "Cuidados cardíacos, Monitorización de signos vitales"
                });
            }

            // Diagnósticos basados en Silverman
            if (datos.silverman > 3) {
                diagnosticos.push({
                    codigo: "00030",
                    diagnostico: "Deterioro del intercambio de gases",
                    relacionado: "Dificultad respiratoria",
                    evidencia: `Silverman: ${datos.silverman} (${silvermanInterpretacion.nivel})`,
                    noc: "Estado respiratorio: intercambio gaseoso",
                    nic: "Monitorización respiratoria, Oxigenoterapia"
                });
            }

            // Diagnóstico de riesgo por prematuridad
            if (datos.edadGestacional < 37) {
                diagnosticos.push({
                    codigo: "00004",
                    diagnostico: "Riesgo de infección",
                    relacionado: "Prematuridad e inmadurez del sistema inmunológico",
                    evidencia: `Edad gestacional: ${datos.edadGestacional} semanas`,
                    noc: "Control del riesgo",
                    nic: "Control de infecciones, Protección contra las infecciones"
                });
            }

            return diagnosticos;
        }

        // Función principal para procesar el formulario
        document.getElementById('clinicalDataForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Recopilar datos del formulario
            const formData = new FormData(this);
            datosActuales = {
                expediente: formData.get('expediente'),
                fechaNacimiento: formData.get('fechaNacimiento'),
                sexo: formData.get('sexo'),
                peso: parseInt(formData.get('peso')),
                talla: parseFloat(formData.get('talla')),
                pc: parseFloat(formData.get('pc')),
                edadGestacional: parseFloat(formData.get('edadGestacional')),
                apgar1: parseInt(formData.get('apgar1')) || 0,
                apgar5: parseInt(formData.get('apgar5')) || 0,
                silverman: parseInt(formData.get('silverman')) || 0
            };

            // Realizar cálculos
            const percentiles = calcularPercentiles(datosActuales.peso, datosActuales.talla, datosActuales.pc, datosActuales.edadGestacional, datosActuales.sexo);
            const apgarInterpretacion = interpretarApgar(datosActuales.apgar1, datosActuales.apgar5);
            const silvermanInterpretacion = interpretarSilverman(datosActuales.silverman);
            const diagnosticos = generarDiagnosticosNANDA(datosActuales, percentiles, apgarInterpretacion, silvermanInterpretacion);

            // Generar reporte
            const reporte = generarReporteCompleto(datosActuales, percentiles, apgarInterpretacion, silvermanInterpretacion, diagnosticos);
            
            // Mostrar resultados
            document.getElementById('clinicalSummary').innerHTML = reporte;
            document.getElementById('resultadosArea').classList.remove('hidden');
            
            // Scroll a resultados
            document.getElementById('resultadosArea').scrollIntoView({ behavior: 'smooth' });
            
            mostrarNotificacion('✅ Análisis completado exitosamente', 'success');
        });

        // Función para generar reporte completo
        function generarReporteCompleto(datos, percentiles, apgarInterpretacion, silvermanInterpretacion, diagnosticos) {
            const fechaActual = new Date().toLocaleDateString('es-ES');
            const infoAutor = JSON.parse(localStorage.getItem('neoclinic_info_autor') || '{}');
            
            return `
                <div class="space-y-6">
                    <!-- Header del Reporte -->
                    <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-xl">
                        <h3 class="text-2xl font-bold mb-2">📋 Reporte Clínico Neonatal</h3>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div><strong>Expediente:</strong> ${datos.expediente}</div>
                            <div><strong>Fecha de Análisis:</strong> ${fechaActual}</div>
                            <div><strong>Sexo:</strong> ${datos.sexo.charAt(0).toUpperCase() + datos.sexo.slice(1)}</div>
                            <div><strong>Fecha de Nacimiento:</strong> ${new Date(datos.fechaNacimiento).toLocaleDateString('es-ES')}</div>
                        </div>
                    </div>

                    <!-- Datos Antropométricos -->
                    <div class="bg-blue-50 p-6 rounded-xl">
                        <h4 class="font-bold text-blue-800 mb-4">📏 Análisis Antropométrico</h4>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-white p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600">${datos.peso}g</div>
                                <div class="text-sm text-gray-600">Peso</div>
                                <div class="text-xs font-medium ${percentiles.peso.includes('<') ? 'text-red-600' : percentiles.peso.includes('>') ? 'text-green-600' : 'text-yellow-600'}">${percentiles.peso}</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600">${datos.talla}cm</div>
                                <div class="text-sm text-gray-600">Talla</div>
                                <div class="text-xs font-medium ${percentiles.talla.includes('<') ? 'text-red-600' : percentiles.talla.includes('>') ? 'text-green-600' : 'text-yellow-600'}">${percentiles.talla}</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600">${datos.pc}cm</div>
                                <div class="text-sm text-gray-600">P. Cefálico</div>
                                <div class="text-xs font-medium ${percentiles.pc.includes('<') ? 'text-red-600' : percentiles.pc.includes('>') ? 'text-green-600' : 'text-yellow-600'}">${percentiles.pc}</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600">${datos.edadGestacional}</div>
                                <div class="text-sm text-gray-600">Sem. Gestación</div>
                                <div class="text-xs font-medium ${datos.edadGestacional < 37 ? 'text-red-600' : datos.edadGestacional > 42 ? 'text-orange-600' : 'text-green-600'}">
                                    ${datos.edadGestacional < 37 ? 'Prematuro' : datos.edadGestacional > 42 ? 'Post-término' : 'A término'}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Escalas Clínicas -->
                    <div class="bg-purple-50 p-6 rounded-xl">
                        <h4 class="font-bold text-purple-800 mb-4">🏥 Evaluación de Escalas Clínicas</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- APGAR -->
                            <div class="bg-white p-4 rounded-lg">
                                <h5 class="font-bold text-gray-700 mb-3">Escala APGAR</h5>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center">
                                        <span>1 minuto:</span>
                                        <span class="font-bold ${apgarInterpretacion.minuto1.color}">${datos.apgar1}/10 - ${apgarInterpretacion.minuto1.nivel}</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>5 minutos:</span>
                                        <span class="font-bold ${apgarInterpretacion.minuto5.color}">${datos.apgar5}/10 - ${apgarInterpretacion.minuto5.nivel}</span>
                                    </div>
                                    <div class="text-sm text-gray-600 mt-2">
                                        <strong>Interpretación:</strong> ${apgarInterpretacion.minuto5.descripcion}
                                    </div>
                                </div>
                            </div>

                            <!-- Silverman -->
                            <div class="bg-white p-4 rounded-lg">
                                <h5 class="font-bold text-gray-700 mb-3">Escala Silverman-Andersen</h5>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center">
                                        <span>Puntuación:</span>
                                        <span class="font-bold ${silvermanInterpretacion.color}">${datos.silverman}/10</span>
                                    </div>
                                    <div class="text-sm">
                                        <strong>Nivel:</strong> <span class="${silvermanInterpretacion.color}">${silvermanInterpretacion.nivel}</span>
                                    </div>
                                    <div class="text-sm text-gray-600">
                                        <strong>Interpretación:</strong> ${silvermanInterpretacion.descripcion}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Diagnósticos NANDA-NOC-NIC -->
                    <div class="bg-green-50 p-6 rounded-xl">
                        <h4 class="font-bold text-green-800 mb-4">🎯 Diagnósticos de Enfermería (NANDA-NOC-NIC)</h4>
                        <div class="space-y-4">
                            ${diagnosticos.map((dx, index) => `
                                <div class="bg-white p-4 rounded-lg border-l-4 border-green-500">
                                    <div class="flex items-start justify-between mb-2">
                                        <h5 class="font-bold text-gray-800">${index + 1}. ${dx.diagnostico}</h5>
                                        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">${dx.codigo}</span>
                                    </div>
                                    <div class="text-sm space-y-1">
                                        <div><strong>Relacionado con:</strong> ${dx.relacionado}</div>
                                        <div><strong>Evidenciado por:</strong> ${dx.evidencia}</div>
                                        <div class="bg-blue-50 p-2 rounded mt-2">
                                            <div><strong>NOC:</strong> ${dx.noc}</div>
                                            <div><strong>NIC:</strong> ${dx.nic}</div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Información del Sistema -->
                    ${infoAutor.autor ? `
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h4 class="font-bold text-indigo-700 mb-4">👨‍⚕️ Información del Proyecto</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div><strong>Elaborado por:</strong> ${infoAutor.autor}</div>
                            <div><strong>Asesora:</strong> ${infoAutor.asesora}</div>
                            <div><strong>Institución:</strong> ${infoAutor.institucion || 'No especificada'}</div>
                            <div><strong>Programa:</strong> ${infoAutor.programa || 'No especificado'}</div>
                            <div class="md:col-span-2"><strong>Sistema:</strong> NeoClinic v1.0 - Sistema Integral de Datos Clínicos Neonatales</div>
                        </div>
                    </div>
                    ` : ''}

                    <!-- Botones de Acción -->
                    <div class="flex flex-wrap gap-4 justify-center">
                        <button onclick="imprimirReporte()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            🖨️ Imprimir Reporte
                        </button>
                        <button onclick="exportarDatos()" 
                                class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            📄 Exportar Datos
                        </button>
                        <button onclick="nuevoAnalisis()" 
                                class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            ➕ Nuevo Análisis
                        </button>
                    </div>
                </div>
            `;
        }

        // Funciones adicionales
        function imprimirReporte() {
            window.print();
        }

        function exportarDatos() {
            const datos = {
                ...datosActuales,
                fechaExportacion: new Date().toISOString(),
                sistema: 'NeoClinic v1.0'
            };
            
            const dataStr = JSON.stringify(datos, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `neoclinic_${datos.expediente}_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            mostrarNotificacion('✅ Datos exportados exitosamente', 'success');
        }

        function nuevoAnalisis() {
            document.getElementById('clinicalDataForm').reset();
            document.getElementById('resultadosArea').classList.add('hidden');
            document.querySelector('#clinicalDataForm').scrollIntoView({ behavior: 'smooth' });
            mostrarNotificacion('📋 Formulario limpio para nuevo análisis', 'info');
        }

        // Cargar información al iniciar la página
        document.addEventListener('DOMContentLoaded', function() {
            cargarInfoAutor();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9928520db422649a',t:'MTc2MTEyOTAzOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
agregar sistema conpleto
